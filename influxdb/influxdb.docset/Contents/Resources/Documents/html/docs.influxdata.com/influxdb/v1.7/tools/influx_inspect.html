<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title> Influx Inspect disk utility | InfluxData Documentation</title>
    <meta name="description" content="Use the &#34;influx_inspect&#34; commands to manage InfluxDB disks and shards.. "/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <link rel="shortcut icon" href="../../../img/favicon.ico" type="image/x-icon"/>

    
    
    
    
    <meta name="docsearch:latest" content="true"/>
    
    

    
    <meta name="robots" content="index, follow"/>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/>
    <link rel="stylesheet" title="dark-theme" href="../../../css/docs-default.css"/>
    <link rel="alternate stylesheet" title="light-theme" href="https://docs.influxdata.com/css/docs-light.css"/>

    <link href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,400italic,500italic,700,700italic,900,900italic" rel="stylesheet" type="text/css"/>

    <meta name="application-name" content="InfluxData"/>
    <meta name="msapplication-TileColor" content=""/>

    <meta name="msapplication-TileImage" content="https://docs.influxdata.com/img/influx-logo-cubo-dark.png"/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@influxdb"/>
    <meta name="twitter:title" content=" Influx Inspect disk utility | InfluxData Documentation"/>
    <meta name="twitter:description" content="Use the &#34;influx_inspect&#34; commands to manage InfluxDB disks and shards.. "/>

    <meta name="twitter:image" content="https://docs.influxdata.com/img/influx-logo-cubo-dark.png"/>

    <meta property="fb:app_id" content="222112578359661"/>
    <meta property="og:title" content=" Influx Inspect disk utility | InfluxData Documentation"/>
    <meta property="og:description" content="Use the &#34;influx_inspect&#34; commands to manage InfluxDB disks and shards.. "/>
    <meta property="og:url" content="https://docs.influxdata.com/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://www.influxdata.com/wp-content/uploads/Simple-Kubo.jpg"/>
    <meta property="og:image:width" content="555px"/>
    <meta property="og:image:height" content="290px"/>

    <meta name="Copyright" content="InfluxData Inc."/>

    
    <script type="text/javascript" src="https://script.crazyegg.com/pages/scripts/0080/4231.js" async="async"></script>

    <script src="../../../js/vendor/js.cookie.js" type="text/javascript"></script>
    <script src="../../../js/docs-themes.js" type="text/javascript"></script>
    <script src="../../../js/docs-chronograf-url.js" type="text/javascript"></script>
    <script type="text/javascript">
        set_style_from_cookie();

    </script>
</head>

<body class="docs-theme--influxdb">
    
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WXRH9C');

    </script>
    
    <nav class="navbar" id="main-nav">
    <div class="navbar--logo">
      <a href="https://www.influxdata.com/" target="_blank" title="Go to InfluxData">
        <span class="icon logo"></span>
        <span class="icon logotype"></span>
      </a>
      <span class="divider"></span>
      <a href="https://docs.influxdata.com/" class="navbar--docs klavika-font" title="Go to Documentation Homepage">Docs</a>
    </div>
    

<div class="navbar--hamburger" id="navbar--hamburger">
    <div class="navbar--hamburger-bar top"></div>
    <div class="navbar--hamburger-bar middle"></div>
    <div class="navbar--hamburger-bar bottom"></div>
</div>
<div class="navbar--product-dropdown" id="navbar--dropdown">
    <div class="navbar--current-product">
      
      
        
        
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      
        
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
          InfluxDB v1.7
        
      
      
        
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      
        
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      
        
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      
        
        
      
        
      
        
      
      
        
        
      
        
      
        
      
        
      
        
      
      
      
    </div>
    <div class="navbar--product-dropdown-caret"><span class="icon arrow-down"></span></div>
</div>
<div class="navbar--product-container" id="navbar--product-container">
    <div class="navbar--dropdown-dismiss" id="navbar--dropdown-dismiss"></div>
    <ul class="navbar--product-menu" id="navbar--product-menu">
        
          
            <li><a class="navbar--product" href="https://docs.influxdata.com/telegraf/v1.13/">Telegraf</a></li>
          
        
          
            <li><a class="navbar--product" href="../index.html">InfluxDB</a></li>
            <li><a class="navbar--product v2" href="https://v2.docs.influxdata.com" target="_blank">InfluxDB 2.0 <span class="v2-status">beta</span></a></li>
          
        
          
            <li><a class="navbar--product" href="https://docs.influxdata.com/enterprise_influxdb/v1.7/">InfluxDB Enterprise</a></li>
          
        
          
            <li><a class="navbar--product" href="https://docs.influxdata.com/chronograf/v1.7/">Chronograf</a></li>
          
        
          
            <li><a class="navbar--product" href="https://docs.influxdata.com/kapacitor/v1.5/">Kapacitor</a></li>
          
        
          
            <li><a class="navbar--product" href="https://docs.influxdata.com/enterprise_kapacitor/v1.5/">Kapacitor Enterprise</a></li>
          
        
          
            <li><a class="navbar--product" href="https://docs.influxdata.com/flux/v0.50/">Flux</a></li>
          
        
        <li class="navbar--product-divider"></li>
        <li><a class="navbar--product external" href="https://influxdata.com/use-cases/" target="_blank">►&nbsp; See how the TICK Stack is used</a></li>
        <li><a class="navbar--product external" href="https://influxdata.com/pricing/" target="_blank">►&nbsp; Need help using our stack?</a></li>
    </ul>
</div>


    <div class="navbar--search" id="navbar--search">
	
	
	
	
			
				<input class="navbar--search-field" id="algolia-search-input" type="text" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" dir="auto" placeholder="Search the docs..."/>
			
		
	
	
	
	
	
	
</div>

    <button class="theme-switcher" id="theme-switch-light" onclick="switch_style(&#39;light-theme&#39;);return false;"><span class="icon sun2"></span></button>
<button class="theme-switcher" id="theme-switch-dark" onclick="switch_style(&#39;dark-theme&#39;);return false;"><span class="icon moon"></span></button>


</nav>


<div class="sidebar--toggle" id="sidebar--toggle">InfluxDB Contents</div>
<aside class="sidebar" id="sidebar">
  <section class="sidebar--section">
    <div id="sidebar--ad"></div>

  </section>
  
  
    
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../about_the_project/index.html">About the project</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../about_the_project/releasenotes-changelog/index.html">Release notes</a></li>
              
            
              
                <li><a class="sidebar--page" href="../about_the_project/contributing/index.html">Contributing</a></li>
              
            
              
                <li><a class="sidebar--page" href="../about_the_project/cla/index.html">Contributor license agreement</a></li>
              
            
              
                <li><a class="sidebar--page" href="../about_the_project/licenses/index.html">InfluxDB license</a></li>
              
            
              
                <li><a class="sidebar--page" href="../about_the_project/third-party/index.html">Third party software</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../introduction/index.html">Introduction</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../introduction/downloading/index.html">Downloading</a></li>
              
            
              
                <li><a class="sidebar--page" href="../introduction/installation/index.html">Installing</a></li>
              
            
              
                <li><a class="sidebar--page" href="../introduction/getting-started/index.html">Getting started</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../concepts/index.html">Concepts</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../concepts/key_concepts/index.html">Key concepts</a></li>
              
            
              
                <li><a class="sidebar--page" href="../concepts/glossary/index.html">Glossary</a></li>
              
            
              
                <li><a class="sidebar--page" href="../concepts/crosswalk/index.html">Comparing InfluxDB to SQL databases</a></li>
              
            
              
                <li><a class="sidebar--page" href="../concepts/insights_tradeoffs/index.html">InfluxDB design insights and tradeoffs</a></li>
              
            
              
                <li><a class="sidebar--page" href="../concepts/schema_and_data_layout/index.html">Schema design and data layout</a></li>
              
            
              
                <li><a class="sidebar--page" href="../concepts/storage_engine/index.html">In-memory indexing with TSM</a></li>
              
            
              
                <li><a class="sidebar--page" href="../concepts/time-series-index/index.html">Time Series Index (TSI) overview</a></li>
              
            
              
                <li><a class="sidebar--page" href="../concepts/tsi-details/index.html">Time Series Index (TSI) details</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../administration/index.html">Administration</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../administration/config/index.html">Configuring InfluxDB</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/authentication_and_authorization/index.html">Authentication and authorization</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/upgrading/index.html">Upgrading</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/https_setup/index.html">Enabling HTTPS</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/logs/index.html">Logging and tracing</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/ports/index.html">Ports</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/backup_and_restore/index.html">Backing up and restoring</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/rebuild-tsi-index/index.html">Rebuild the TSI index</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/security/index.html">Managing security</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/server_monitoring/index.html">Server monitoring</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/stability_and_compatibility/index.html">Stability and compatibility</a></li>
              
            
              
                <li><a class="sidebar--page" href="../administration/subscription-management/index.html">Manage subscriptions</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class=" active" href="index.html">Tools</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="shell/index.html">InfluxDB command line interface (CLI/shell)</a></li>
              
            
              
                <li><a class="sidebar--page" href="api/index.html">InfluxDB API reference</a></li>
              
            
              
                <li><a class="sidebar--page" href="api_client_libraries/index.html">InfluxDB API client libraries</a></li>
              
            
              
                <li><a class="sidebar--page active" href="influx_inspect/index.html">Influx Inspect disk utility</a></li>
              
            
              
                <li><a class="sidebar--page" href="inch/index.html">InfluxDB inch tool</a></li>
              
            
              
                <li><a class="sidebar--page" href="https://grafana.com/docs/grafana/latest/features/datasources/influxdb/">Grafana graphs and dashboards</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../query_language/index.html">Influx Query Language (InfluxQL)</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../query_language/data_download/index.html">Sample data</a></li>
              
            
              
                <li><a class="sidebar--page" href="../query_language/data_exploration/index.html">Data exploration</a></li>
              
            
              
                <li><a class="sidebar--page" href="../query_language/schema_exploration/index.html">Schema exploration</a></li>
              
            
              
                <li><a class="sidebar--page" href="../query_language/database_management/index.html">Data management</a></li>
              
            
              
                <li><a class="sidebar--page" href="../query_language/continuous_queries/index.html">Continuous Queries</a></li>
              
            
              
                <li><a class="sidebar--page" href="../query_language/functions/index.html">Functions</a></li>
              
            
              
                <li><a class="sidebar--page" href="../query_language/math_operators/index.html">Mathematical operators</a></li>
              
            
              
                <li><a class="sidebar--page" href="../query_language/spec/index.html">InfluxQL reference</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../write_protocols/index.html">Write protocols</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../write_protocols/line_protocol_reference/index.html">InfluxDB line protocol reference</a></li>
              
            
              
                <li><a class="sidebar--page" href="../write_protocols/line_protocol_tutorial/index.html">InfluxDB line protocol tutorial</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../supported_protocols/index.html">Supported protocols</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../supported_protocols/collectd/index.html">CollectD</a></li>
              
            
              
                <li><a class="sidebar--page" href="../supported_protocols/graphite/index.html">Graphite</a></li>
              
            
              
                <li><a class="sidebar--page" href="../supported_protocols/opentsdb/index.html">OpenTSDB</a></li>
              
            
              
                <li><a class="sidebar--page" href="../supported_protocols/prometheus/index.html">Prometheus</a></li>
              
            
              
                <li><a class="sidebar--page" href="../supported_protocols/udp/index.html">UDP</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../high_availability/index.html">High availability</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../high_availability/clusters/index.html">Clustering</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../troubleshooting/index.html">Troubleshooting</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../troubleshooting/frequently-asked-questions/index.html">Frequently asked questions (FAQ)</a></li>
              
            
              
                <li><a class="sidebar--page" href="../troubleshooting/query_management/index.html">Query management</a></li>
              
            
              
                <li><a class="sidebar--page" href="../troubleshooting/errors/index.html">Error messages</a></li>
              
            
            </ul>
          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="../additional_resources/additional_resources/index.html">Additional resources</a>
          </div>

          

        </section>
      
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="" href="influx_inspect.html">Guides</a>
          </div>

          
            <ul>
            
              
                <li><a class="sidebar--page" href="../guides/writing_data/index.html">Writing data with the InfluxDB API</a></li>
              
            
              
                <li><a class="sidebar--page" href="../guides/querying_data/index.html">Querying data with the InfluxDB API</a></li>
              
            
              
                <li><a class="sidebar--page" href="../guides/downsampling_and_retention/index.html">Downsampling and data retention</a></li>
              
            
              
                <li><a class="sidebar--page" href="../guides/hardware_sizing/index.html">Hardware sizing guidelines</a></li>
              
            
              
                <li><a class="sidebar--page" href="../guides/calculating_percentages/index.html">Calculating percentages in a query</a></li>
              
            
            </ul>
          

        </section>
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
  <section class="sidebar--section">
    <div class="sidebar--section-title">
      <a href="https://docs.influxdata.com/influxdb/">InfluxDB versions</a>
    </div>
    <ul>
      
      <li><a class="sidebar--page" href="../index.html">v1.7</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v1.6/">v1.6</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v1.5/">v1.5</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v1.4/">v1.4</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v1.3/">v1.3</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v1.2/">v1.2</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v1.1/">v1.1</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v1.0/">v1.0</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v0.13/">v0.13</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v0.12/">v0.12</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v0.11/">v0.11</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v0.10/">v0.10</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v0.9/">v0.9</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v0.8/">v0.8</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v0.7/">v0.7</a></li>
      
      <li><a class="sidebar--page" href="https://docs.influxdata.com/influxdb/v0.6/">v0.6</a></li>
      
    </ul>
  </section>
</aside>

<article class="article">
	
	<section class="article-section article-heading">
		<div class="article-content">
			<h1>Influx Inspect disk utility</h1>
		</div>
	</section>
	
	<section class="article-section">
		<div class="article-content">
			

			

<p>Influx Inspect is an InfluxDB disk utility that can be used to:</p>

<ul>
<li>View detailed information about disk shards.</li>
<li>Export data from a shard to <a href="../concepts/glossary/index.html#influxdb-line-protocol">InfluxDB line protocol</a> that can be inserted back into the database.</li>
<li>Convert TSM index shards to TSI index shards.</li>
</ul>

<h2 id="influx-inspect-utility"><code>influx_inspect</code> utility</h2>

<h3 id="syntax">Syntax</h3>

<pre><code>influx_inspect [ [ command ] [ options ] ]`
</code></pre>

<p><code>-help</code> is the default command and prints syntax and usage information for the tool.</p>

<h3 id="influx-inspect-commands"><code>influx_inspect</code> commands</h3>

<p>The <code>influx_inspect</code> commands are summarized here, with links to detailed information on each of the commands.</p>

<ul>
<li><a href="influx_inspect.html#buildtsi"><code>buildtsi</code></a>: Converts in-memory (TSM-based) shards to TSI.</li>
<li><a href="influx_inspect.html#deletetsm"><code>deletetsm</code></a>: Bulk deletes a measurement from a raw TSM file.</li>
<li><a href="influx_inspect.html#dumptsi"><code>dumptsi</code></a>: Dumps low-level details about TSI files.</li>
<li><a href="influx_inspect.html#dumptsm"><code>dumptsm</code></a>: Dumps low-level details about TSM files.</li>
<li><a href="influx_inspect.html#dumptsmwal"><code>dumptsmwal</code></a>: Dump all data from a WAL file.<br/></li>
<li><a href="influx_inspect.html#export"><code>export</code></a>: Exports raw data from a shard in InfluxDB line protocol format.</li>
<li><a href="influx_inspect.html#report"><code>report</code></a>: Displays a shard level report.</li>
<li><a href="influx_inspect.html#reporttsi"><code>reporttsi</code></a>: Reports on cardinality for measurements and shards.</li>
<li><a href="influx_inspect.html#verify"><code>verify</code></a>: Verifies the integrity of TSM files.</li>
<li><a href="influx_inspect.html#verify-seriesfile"><code>verify-seriesfile</code></a>: Verifies the integrity of series files.</li>
</ul>

<h3 id="buildtsi"><code>buildtsi</code></h3>

<p>Builds TSI (Time Series Index) disk-based shard index files and associated series files.
The index is written to a temporary location until complete and then moved to a permanent location.
If an error occurs, then this operation will fall back to the original in-memory index.</p>

<blockquote>
<p><strong><em>Note:</em></strong> <strong>For offline conversion only.</strong>
When TSI is enabled, new shards use the TSI indexes.
Existing shards continue as TSM-based shards until
converted offline.</p>
</blockquote>

<h5 id="syntax-1">Syntax</h5>

<pre><code>influx_inspect buildtsi -datadir &lt;data_dir&gt; -waldir &lt;wal_dir&gt; [ options ]
</code></pre>

<blockquote>
<p><strong>Note:</strong> Use the <code>buildtsi</code> command with the user account that you are going to run the database as,
or ensure that the permissions match after running the command.</p>
</blockquote>

<h4 id="options">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="batch-size"><code>[ -batch-size ]</code></h5>

<p>The size of the batches written to the index. Default value is <code>10000</code>.</p>


<div class="warn">
  <strong>Warning:</strong> Setting this value can have adverse effects on performance and heap size.
</div>


<h5 id="concurrency"><code>[ -concurrency ]</code></h5>

<p>The number of workers to dedicate to shard index building.
Defaults to <a href="../administration/config.html#gomaxprocs-environment-variable"><code>GOMAXPROCS</code></a> value.</p>

<h5 id="database-db-name"><code>[ -database &lt;db_name&gt; ]</code></h5>

<p>The name of the database.</p>

<h5 id="datadir-data-dir"><code>-datadir &lt;data_dir&gt;</code></h5>

<p>The path to the <code>data</code> directory.</p>

<h5 id="max-cache-size"><code>[ -max-cache-size ]</code></h5>

<p>The maximum size of the cache before it starts rejecting writes.
This value overrides the configuration setting for
<code>[data] cache-max-memory-size</code>.
Default value is <code>1073741824</code>.</p>

<h5 id="max-log-file-size"><code>[ -max-log-file-size ]</code></h5>

<p>The maximum size of the log file. Default value is <code>1048576</code>.</p>

<h5 id="retention-rp-name"><code>[ -retention &lt;rp_name&gt; ]</code></h5>

<p>The name of the retention policy.</p>

<h5 id="shard-shard-id"><code>[ -shard &lt;shard_ID&gt; ]</code></h5>

<p>The identifier of the shard.</p>

<h5 id="v"><code>[ -v ]</code></h5>

<p>Flag to enable output in verbose mode.</p>

<h5 id="waldir-wal-dir"><code>-waldir &lt;wal_dir&gt;</code></h5>

<p>The directory for the WAL (Write Ahead Log) files.</p>

<h4 id="examples">Examples</h4>

<h5 id="converting-all-shards-on-a-node">Converting all shards on a node</h5>

<pre><code>$ influx_inspect buildtsi -datadir ~/.influxdb/data -waldir ~/.influxdb/wal

</code></pre>

<h5 id="converting-all-shards-for-a-database">Converting all shards for a database</h5>

<pre><code>$ influx_inspect buildtsi -database mydb -datadir ~/.influxdb/data -waldir ~/.influxdb/wal

</code></pre>

<h5 id="converting-a-specific-shard">Converting a specific shard</h5>

<pre><code>$ influx_inspect buildtsi -database stress -shard 1 -datadir ~/.influxdb/data -waldir ~/.influxdb/wal
</code></pre>

<h3 id="deletetsm"><code>deletetsm</code></h3>

<p>Bulk deletes a measurement from a raw TSM file.</p>


<div class="warn">
  <strong>Warning:</strong> Use the <code>deletetsm</code> command only when your InfluxDB instance is offline (<code>influxd</code> service is not running).
</div>


<h4 id="syntax-2">Syntax</h4>

<pre><code>influx_inspect deletetsm -measurement &lt;measurement_name&gt; [ arguments ] &lt;path&gt;
</code></pre>

<h5 id="path"><code>&lt;path&gt;</code></h5>

<p>Path to the <code>.tsm</code> file, located by default in the <code>data</code> directory.</p>

<p>When specifying the path, wildcards (<code>*</code>) can replace one or more characters.</p>

<h4 id="examples-1">Examples</h4>

<h5 id="delete-a-measurement-from-a-single-shard">Delete a measurement from a single shard</h5>

<pre><code>./influx_inspect deletetsm -sanitize /influxdb/data/location/autogen/1384/*.tsm
</code></pre>

<h5 id="delete-a-measurement-from-all-shards-in-the-database">Delete a measurement from all shards in the database</h5>

<pre><code>./influx_inspect deletetsm -sanitize /influxdb/data/location/autogen/*/*.tsm
</code></pre>

<h4 id="options-1">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="measurement"><code>-measurement</code></h5>

<p>The name of the measurement to delete from TSM files.</p>

<h5 id="sanitize">[ <code>-sanitize</code> ]</h5>

<p>Flag to remove all keys containing non-printable Unicode characters.</p>

<h5 id="v-1">[ <code>-v</code> ]</h5>

<p>Flag to enable verbose logging.</p>

<h3 id="dumptsi"><code>dumptsi</code></h3>

<p>Dumps low-level details about TSI files, including <code>.tsl</code> log files and <code>.tsi</code> index files.</p>

<h4 id="syntax-3">Syntax</h4>

<pre><code>influx_inspect dumptsi [ options ] &lt;index_path&gt;
</code></pre>

<p>If no options are specified, summary statistics are provided for each file.</p>

<h4 id="options-2">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="series-file-series-path"><code>-series-file &lt;series_path&gt;</code></h5>

<p>Path to the <code>_series</code> directory under the database <code>data</code> directory. Required.</p>

<h5 id="series">[ <code>-series</code> ]</h5>

<p>Dump raw series data.</p>

<h5 id="measurements">[ <code>-measurements</code> ]</h5>

<p>Dump raw <a href="../concepts/glossary/index.html#measurement">measurement</a> data.</p>

<h5 id="tag-keys">[ <code>-tag-keys</code> ]</h5>

<p>Dump raw <a href="../concepts/glossary/index.html#tag-key">tag keys</a>.</p>

<h5 id="tag-values">[ <code>-tag-values</code> ]</h5>

<p>Dump raw <a href="../concepts/glossary/index.html#tag-value">tag values</a>.</p>

<h5 id="tag-value-series">[ <code>-tag-value-series</code> ]</h5>

<p>Dump raw series for each tag value.</p>

<h5 id="measurement-filter-regular-expression">[ <code>-measurement-filter &lt;regular_expression&gt;</code> ]</h5>

<p>Filter data by measurement regular expression.</p>

<h5 id="tag-key-filter-regular-expression">[ <code>-tag-key-filter &lt;regular_expression&gt;</code> ]</h5>

<p>Filter data by tag key regular expression.</p>

<h5 id="tag-value-filter-regular-expresssion">[ <code>-tag-value-filter &lt;regular_expresssion&gt;</code> ]</h5>

<p>Filter data by tag value regular expression.</p>

<h4 id="examples-2">Examples</h4>

<h5 id="specifying-paths-to-the-series-and-index-directories">Specifying paths to the <code>_series</code> and <code>index</code> directories</h5>

<pre><code>$ influx_inspect dumptsi -series-file /path/to/db/_series /path/to/index
</code></pre>

<h5 id="specifying-paths-to-the-series-directory-and-an-index-file">Specifying paths to the <code>_series</code> directory and an <code>index</code> file</h5>

<pre><code>$ influx_inspect dumptsi -series-file /path/to/db/_series /path/to/index/file0
</code></pre>

<h5 id="specifying-paths-to-the-series-directory-and-multiple-index-files">Specifying paths to the <code>_series</code> directory and multiple <code>index</code> files</h5>

<pre><code>$ influx_inspect dumptsi -series-file /path/to/db/_series /path/to/index/file0 /path/to/index/file1 ...
</code></pre>

<h3 id="dumptsm"><code>dumptsm</code></h3>

<p>Dumps low-level details about <a href="../concepts/glossary/index.html#tsm-time-structured-merge-tree">TSM</a> files, including TSM (<code>.tsm</code>) files and WAL (<code>.wal</code>) files.</p>

<h4 id="syntax-4">Syntax</h4>

<pre><code>influx_inspect dumptsm [ options ] &lt;path&gt;
</code></pre>

<h5 id="path-1"><code>&lt;path&gt;</code></h5>

<p>Path to the <code>.tsm</code> file, located by default in the <code>data</code> directory.</p>

<h4 id="options-3">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="index">[ <code>-index</code> ]</h5>

<p>Flag to dump raw index data.
Default value is <code>false</code>.</p>

<h5 id="blocks">[ <code>-blocks</code> ]</h5>

<p>Flag to dump raw block data.
Default value is <code>false</code>.</p>

<h5 id="all">[ <code>-all</code> ]</h5>

<p>Flag to dump all data. Caution: This may print a lot of information.
Default value is <code>false</code>.</p>

<h5 id="filter-key-key-name">[ <code>-filter-key &lt;key_name&gt;</code> ]</h5>

<p>Display only index data and block data that match this key substring.
Default value is <code>&#34;&#34;</code>.</p>

<h3 id="dumptsmwal"><code>dumptsmwal</code></h3>

<p>Dumps all entries from one or more WAL (<code>.wal</code>) files only and excludes TSM (<code>.tsm</code>) files.</p>

<h4 id="syntax-5">Syntax</h4>

<pre><code>influx_inspect dumptsmwal [ options ] &lt;wal_dir&gt;
</code></pre>

<h4 id="options-4">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="show-duplicates">[ <code>-show-duplicates</code> ]</h5>

<p>Flag to show keys which have duplicate or out-of-order timestamps.
If a user writes points with timestamps set by the client, then multiple points with the same timestamp (or with time-descending timestamps) can be written.</p>

<h3 id="export"><code>export</code></h3>

<p>Exports all TSM files in InfluxDB line protocol data format.
Writes all WAL file data for <code>_internal/monitor</code>.
This output file can be imported using the
<a href="shell/index.html#import-data-from-a-file-with-import">influx</a> command.</p>

<h4 id="syntax-6">Syntax</h4>

<pre><code>influx_inspect export [ options ]
</code></pre>

<h4 id="options-5">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="compress">[ <code>-compress</code> ]</h5>

<p>The flag to compress the output using gzip compression.
Default value is <code>false</code>.</p>

<h5 id="database-db-name-1">[ <code>-database &lt;db_name&gt;</code> ]</h5>

<p>The name of the database to export.
Default value is <code>&#34;&#34;</code>.</p>

<h5 id="datadir-data-dir-1"><code>-datadir &lt;data_dir&gt;</code></h5>

<p>The path to the <code>data</code> directory.
Default value is <code>&#34;$HOME/.influxdb/data&#34;</code>.</p>

<h5 id="end-timestamp">[ <code>-end &lt;timestamp&gt;</code> ]</h5>

<p>The timestamp for the end of the time range. Must be in <a href="https://tools.ietf.org/html/rfc3339">RFC3339 format</a>.</p>

<p>RFC3339 requires very specific formatting. For example, to indicate no time zone offset (UTC+0), you must include Z or +00:00 after seconds. Examples of valid RFC3339 formats include:</p>

<p><strong>No offset</strong></p>

<pre><code>YYYY-MM-DDTHH:MM:SS+00:00 
YYYY-MM-DDTHH:MM:SSZ 
YYYY-MM-DDTHH:MM:SS.nnnnnnZ (fractional seconds (.nnnnnn) are optional)
</code></pre>

<p><strong>With offset</strong></p>

<pre><code>YYYY-MM-DDTHH:MM:SS-08:00
YYYY-MM-DDTHH:MM:SS+07:00
</code></pre>

<blockquote>
<p><strong>Note:</strong> With offsets, avoid replacing the + or - sign with a Z. It may cause an error or print Z (ISO 8601 behavior) instead of the time zone offset.</p>
</blockquote>

<h5 id="out-export-dir">[ <code>-out &lt;export_dir&gt;</code> ]</h5>

<p>The location for the export file.
Default value is <code>&#34;$HOME/.influxdb/export&#34;</code>.</p>

<h5 id="retention-rp-name-1">[ <code>-retention &lt;rp_name&gt;</code> ]</h5>

<p>The name of the <a href="../concepts/glossary/index.html#retention-policy-rp">retention policy</a> to export. Default value is <code>&#34;&#34;</code>.</p>

<h5 id="start-timestamp">[ <code>-start &lt;timestamp&gt;</code> ]</h5>

<p>The timestamp for the start of the time range.
The timestamp string must be in <a href="https://tools.ietf.org/html/rfc3339">RFC3339 format</a>.</p>

<h5 id="waldir-wal-dir-1">[ <code>-waldir &lt;wal_dir&gt;</code> ]</h5>

<p>Path to the <a href="../concepts/glossary/index.html#wal-write-ahead-log">WAL</a> directory.
Default value is <code>&#34;$HOME/.influxdb/wal&#34;</code>.</p>

<h4 id="examples-3">Examples</h4>

<h5 id="export-all-databases-and-compress-the-output">Export all databases and compress the output</h5>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">influx_inspect <span class="nb">export</span> -compress</code></pre></div>
<h5 id="export-data-from-a-specific-database-and-retention-policy">Export data from a specific database and retention policy</h5>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">influx_inspect <span class="nb">export</span> -database mydb -retention autogen</code></pre></div>
<h5 id="output-file">Output file</h5>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># DDL
</span><span class="c1"></span>CREATE DATABASE MY_DB_NAME
CREATE RETENTION POLICY autogen ON MY_DB_NAME DURATION inf REPLICATION <span class="m">1</span>

<span class="c1"># DML
</span><span class="c1"># CONTEXT-DATABASE:MY_DB_NAME
</span><span class="c1"># CONTEXT-RETENTION-POLICY:autogen
</span><span class="c1"></span>randset <span class="nv">value</span><span class="o">=</span><span class="m">97</span>.9296104805 <span class="m">1439856000000000000</span>
randset <span class="nv">value</span><span class="o">=</span><span class="m">25</span>.3849066842 <span class="m">1439856100000000000</span></code></pre></div>
<h3 id="report"><code>report</code></h3>

<p>Displays series metadata for all shards.
The default location is <code>$HOME/.influxdb</code>.</p>

<h4 id="syntax-7">Syntax</h4>

<pre><code>influx_inspect report [ options ]
</code></pre>

<h4 id="options-6">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="pattern-regular-expression-wildcard">[ <code>-pattern &#34;&lt;regular expression/wildcard&gt;&#34;</code> ]</h5>

<p>The regular expression or wildcard pattern to match included files.
Default value is <code>&#34;&#34;</code>.</p>

<h5 id="detailed">[ <code>-detailed</code> ]</h5>

<p>The flag to report detailed cardinality estimates.
Default value is <code>false</code>.</p>

<h5 id="exact">[ <code>-exact</code> ]</h5>

<p>The flag to report exact cardinality counts instead of estimates.
Default value is <code>false</code>.
Note: This can use a lot of memory.</p>

<h3 id="reporttsi"><code>reporttsi</code></h3>

<p>The report does the following:</p>

<ul>
<li>Calculates the total exact series cardinality in the database.</li>
<li>Segments that cardinality by measurement, and emits those cardinality values.</li>
<li>Emits total exact cardinality for each shard in the database.</li>
<li>Segments for each shard the exact cardinality for each measurement in the shard.</li>
<li>Optionally limits the results in each shard to the &ldquo;top n&rdquo;.</li>
</ul>

<p>The <code>reporttsi</code> command is primarily useful when there has been a change in cardinality
and it&rsquo;s not clear which measurement is responsible for this change, and further, <em>when</em>
that change happened. Estimating an accurate cardinality breakdown for each measurement
and for each shard will help answer those questions.</p>

<h3 id="syntax-8">Syntax</h3>

<pre><code>influx_inspect reporttsi -db-path &lt;path-to-db&gt; [ options ]
</code></pre>

<h4 id="options-7">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="db-path-path-to-db"><code>-db-path &lt;path-to-db&gt;</code></h5>

<p>The path to the database.</p>

<h5 id="top-n">[ <code>-top &lt;n&gt;</code> ]</h5>

<p>Limits the results to the top specified number within each shard.</p>

<h4 id="performance">Performance</h4>

<p>The <code>reporttsi</code> command uses simple slice/maps to store low cardinality measurements, which saves on the cost of initializing bitmaps.
For high cardinality measurements the tool uses <a href="https://roaringbitmap.org/">roaring bitmaps</a>, which means we don&rsquo;t need to store all series IDs on the heap while running the tool.
Conversion from low-cardinality to high-cardinality representations is done automatically while the tool runs.</p>

<h3 id="verify"><code>verify</code></h3>

<p>Verifies the integrity of TSM files.</p>

<h4 id="syntax-9">Syntax</h4>

<pre><code>influx_inspect verify [ options ]
</code></pre>

<h4 id="options-8">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="dir-storage-root"><code>-dir &lt;storage_root&gt;</code></h5>

<p>The path to the storage root directory.
​Default value is <code>&#34;/root/.influxdb&#34;</code>.</p>

<h3 id="verify-seriesfile"><code>verify-seriesfile</code></h3>

<p>Verifies the integrity of series files.</p>

<h4 id="syntax-10">Syntax</h4>

<pre><code>influx_inspect verify-seriesfile [ options ]
</code></pre>

<h4 id="options-9">Options</h4>

<p>Optional arguments are in brackets.</p>

<h5 id="c-number">[ <code>-c &lt;number&gt;</code> ]</h5>

<p>Specifies the number of concurrent workers to run for this command. Default is equal to the value of GOMAXPROCS. If performance is adversely impacted, you can set a lower value.</p>

<h5 id="dir-path">[ <code>-dir &lt;path&gt;</code> ]</h5>

<p>Specifies the root data path. Defaults to <code>~/.influxdb/data</code>.</p>

<h5 id="db-db-name">[ <code>-db &lt;db_name&gt;</code> ]</h5>

<p>Restricts verifying series files to the specified database in the data directory.</p>

<h5 id="series-file-path">[ <code>-series-file &lt;path&gt;</code> ]</h5>

<p>Path to a specific series file; overrides <code>-db</code> and <code>-dir</code>.</p>

<h5 id="v-2">[ <code>-v</code> ]</h5>

<p>Enables verbose logging.</p>

<h2 id="caveats">Caveats</h2>

<p>The system does not have access to the metastore when exporting TSM shards.
As such, it always creates the <a href="../concepts/glossary/index.html#retention-policy-rp">retention policy</a> with infinite duration and replication factor of 1.  End users may want to change this prior to reimporting if they are importing to a cluster or want a different duration
for retention.</p>

		</div>
	</section>
	
<section class="article-section article-footer">
	<div class="article-content">
		<p><span class="icon logo" style="margin-right: 1em;"></span> This documentation is <a href="https://github.com/influxdata/docs.influxdata.com/blob/master/content/influxdb/v1.7/tools/influx_inspect.md">open source</a>. See a typo? Please, open an <a href="https://github.com/influxdata/docs.influxdata.com/issues/new">issue</a>.</p>
		<br/>
		<p><span class="icon bubbles2" style="margin-right: 1em;"></span><strong>Need help getting up and running?</strong> <a href="https://www.influxdata.com/products/services/" target="_blank">Get Support</a></p>
	</div>
</section>


</article>
<script>window.jQuery || document.write('<script src="../../../js/vendor/jquery-2.1.4.min.js"><\/script>')</script>

<script src="../../../js/docs-interactions.js" type="text/javascript"></script>
<script>
  $("h2, h3, h4").each(function() {
  var link = "<a href="https://docs.influxdata.com/influxdb/v1.7/tools/\&quot;#"" + $(this).attr("id") + "\"></a>"
  $(this).wrapInner( link );
  })
</script>
<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-45024174-5', 'auto');ga('send', 'pageview');</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
  docsearch({
    apiKey: 'ba4435a9d456ac0d954cc276206eac06',
    appId: 'WHM9UWMP6M',
    indexName: 'influxdata',
    inputSelector: '#algolia-search-input',
    algoliaOptions: {
      hitsPerPage: 15,
      facets: [ "project", "version", "latest"],
      facetFilters: [ "latest:true" ]
    }
  });
</script>



<div class="modal-overlay"></div>
<div id="chronograf-url-modal" class="modal-content">
    <label>Chronograf Data Explorer URL</label>
    <form class="flex-form" id="save-chronograf-url">
        <input type="text" id="chronograf-url" name="chronograf-url"/>
        <button class="save-btn"><span>Save</span></button>
    </form>
    <a id="default-chronograf-url">Revert to Default</a>
</div>

</body></html>