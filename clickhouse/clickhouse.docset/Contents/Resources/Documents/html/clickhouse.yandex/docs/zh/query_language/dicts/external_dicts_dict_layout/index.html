<!DOCTYPE html><html lang="zh" class="no-js"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><link href="index.html" rel="canonical"/><meta name="lang:clipboard.copy" content="复制"/><meta name="lang:clipboard.copied" content="已复制"/><meta name="lang:search.language" content="en"/><meta name="lang:search.pipeline.stopwords" content=""/><meta name="lang:search.pipeline.trimmer" content=""/><meta name="lang:search.result.none" content="没有找到符合条件的结果"/><meta name="lang:search.result.one" content="找到 1 个符合条件的结果"/><meta name="lang:search.result.other" content="# 个符合条件的结果"/><meta name="lang:search.tokenizer" content="[\uff0c\u3002]+"/><link rel="shortcut icon" href="../../../assets/images/favicon.ico"/><title>字典的内存布局 - ClickHouse文档</title><link rel="stylesheet" href="../../../assets/stylesheets/application.2a88008a.css"/><link rel="stylesheet" href="../../../assets/stylesheets/application-palette.792431c1.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/><link rel="stylesheet" href="../../../assets/stylesheets/custom.css@1578425159.css"/></head> <body dir="ltr" data-md-color-primary="white" data-md-color-accent="white" class="md-lang-zh"> <svg class="md-svg"> <defs> <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"></path></svg> </defs> </svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer"/> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search"/> <label class="md-overlay" data-md-component="overlay" for="drawer"></label> <header class="md-header" data-md-component="header"> <nav class="md-header-nav md-grid"> <div class="md-flex"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="https://clickhouse.yandex/" title="ClickHouse文档 " class="md-header-nav__button md-logo"> <img src="../../../images/logo.svg" width="40" height="40"/> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"> <span class="md-header-nav__topic"> ClickHouse文档 </span> <span class="md-header-nav__topic"> 字典的内存布局 </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for="search"></label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="search"></label> <div class="md-search__inner"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" required="" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query"/> <label class="md-icon md-search__icon" for="search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset"></button> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="result"> <div class="md-search-result__meta"> 键入以开始搜索 </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div id="md-language-switch" class="md-header-nav__source"> <a class="md-alt-lang" href="https://clickhouse.yandex/docs/en/query_language/dicts/external_dicts_dict_layout/" class="md-flex__ellipsis md-header-nav__title" title="English"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" preserveAspectRatio="none"> <clipPath id="t"> <path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"></path> </clipPath> <path fill="#00247d" d="M0,0 v30 h60 v-30 z"></path> <path stroke="#fff" stroke-width="6" d="M0,0 L60,30 M60,0 L0,30"></path> <path clip-path="url(#t)" stroke="#cf142b" stroke-width="4" d="M0,0 L60,30 M60,0 L0,30"></path> <path stroke="#fff" stroke-width="10" d="M30,0 v30 M0,15 h60"></path> <path stroke="#cf142b" stroke-width="6" d="M30,0 v30 M0,15 h60"></path> </svg> </a> <a class="md-alt-lang" href="https://clickhouse.yandex/docs/ru/query_language/dicts/external_dicts_dict_layout/" class="md-flex__ellipsis md-header-nav__title" title="Russian"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 6" preserveAspectRatio="none"> <rect fill="#fff" width="9" height="3"></rect> <rect fill="#d52b1e" y="3" width="9" height="3"></rect> <rect fill="#0039a6" y="2" width="9" height="2"></rect> </svg> </a> <a class="md-alt-lang md-current-lang" href="index.html" class="md-flex__ellipsis md-header-nav__title" title="Chinese"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 30 20" preserveAspectRatio="none"> <defs> <path id="s" fill="#ffde00" d="M0,-1 0.587785,0.809017 -0.951057,-0.309017H0.951057L-0.587785,0.809017z"></path> </defs> <rect width="30" height="20" fill="#de2910"></rect> <use xlink:href="#s" transform="translate(5,5) scale(3)"></use> <use xlink:href="#s" transform="translate(10,2) rotate(23.036243)"></use> <use xlink:href="#s" transform="translate(12,4) rotate(45.869898)"></use> <use xlink:href="#s" transform="translate(12,7) rotate(69.945396)"></use> <use xlink:href="#s" transform="translate(10,9) rotate(20.659808)"></use> </svg> </a> <a class="md-alt-lang" href="https://clickhouse.yandex/docs/ja/query_language/dicts/external_dicts_dict_layout/" class="md-flex__ellipsis md-header-nav__title" title="Japanese"> <!--?xml version="1.0" encoding="UTF-8"?--> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="90px" height="60px" viewBox="0 0 90 60" version="1.1"> <g id="surface1"> <rect x="0" y="0" width="90" height="60" style="fill:rgb(62.7451%,62.7451%,62.7451%);fill-opacity:1;stroke:none;"></rect> <path style=" stroke:none;fill-rule:nonzero;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 0.601562 0.601562 L 89.398438 0.601562 L 89.398438 59.398438 L 0.601562 59.398438 Z M 0.601562 0.601562 "></path> <path style=" stroke:none;fill-rule:nonzero;fill:rgb(74.509805%,0%,14.901961%);fill-opacity:1;" d="M 63 30 C 63 39.941406 54.941406 48 45 48 C 35.058594 48 27 39.941406 27 30 C 27 20.058594 35.058594 12 45 12 C 54.941406 12 63 20.058594 63 30 Z M 63 30 "></path> </g> </svg> </a> <a class="md-alt-lang" href="https://clickhouse.yandex/docs/fa/query_language/dicts/external_dicts_dict_layout/" class="md-flex__ellipsis md-header-nav__title" title="Farsi"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 630 360" preserveAspectRatio="none"> <rect width="630" height="360" fill="#da0000"></rect> <rect width="630" height="240" fill="#fff"></rect> <rect width="630" height="120" fill="#239f40"></rect> <g transform="translate(8.4,100.4)"> <g id="tb4"> <g id="tb1" fill="none" stroke="#fff" stroke-width="2"> <path id="tbp1" d="M0,1H26M1,10V5H9V9H17V5H12M4,9H6M26,9H21V5H29M29,0V9H37V0M33,0V9" transform="scale(1.4)"></path> <path id="tbp2" d="M0,7H9M10,7H19" transform="scale(2.8)"></path> <use xlink:href="#tbp2" y="120"></use> <use xlink:href="#tbp1" y="145.2"></use> </g> <g id="tb3"> <use xlink:href="#tb1" x="56"></use> <use xlink:href="#tb1" x="112"></use> <use xlink:href="#tb1" x="168"></use> </g> </g> <use xlink:href="#tb3" x="168"></use> <use xlink:href="#tb4" x="392"></use> </g> <g fill="#da0000" transform="matrix(45,0,0,45,315,180)"> <g id="emblem_half"> <path d="M-0.54815,0.83638A0.912046,0.912046 0 0,0 0.328544,-0.722384A1,1 0 0,1 -0.54815,0.83638"></path> <path d="M0.618339,0.661409A0.763932,0.763932 0 0,0 0.421644,-0.741049A1,1 0 0,1 0.618339,0.661409"></path> <path d="M0,1 -0.05,0 0,-0.787278A0.309995,0.309995 0 0,0 0.118034,-0.688191V-0.100406L0.077809,0.892905z"></path> <path d="M-0.02,-0.85 0,-0.831217A0.14431,0.14431 0 0,0 0.252075,-0.967708A0.136408,0.136408 0 0,1 0,-0.924634"></path> </g> <use xlink:href="#emblem_half" transform="scale(-1,1)"></use> </g> </svg> </a> </div> </div> </div> </nav> </header> <div class="md-container"> <main class="md-main"> <div class="md-main__inner md-grid" data-md-component="container"> <div class="md-sidebar md-sidebar--primary" data-md-component="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title md-nav__title--site" for="drawer"> ClickHouse文档 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1"/> <label class="md-nav__link" for="nav-1"> 介绍 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-1"> 介绍 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../index.html" title="概貌" class="md-nav__link"> 概貌 </a> </li> <li class="md-nav__item"> <a href="../../../introduction/distinctive_features/index.html" title="ClickHouse的独特功能" class="md-nav__link"> ClickHouse的独特功能 </a> </li> <li class="md-nav__item"> <a href="../../../introduction/features_considered_disadvantages/index.html" title="ClickHouse功能可被视为缺点" class="md-nav__link"> ClickHouse功能可被视为缺点 </a> </li> <li class="md-nav__item"> <a href="../../../introduction/performance/index.html" title="性能" class="md-nav__link"> 性能 </a> </li> <li class="md-nav__item"> <a href="../../../introduction/history/index.html" title="历史" class="md-nav__link"> 历史 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"/> <label class="md-nav__link" for="nav-2"> 入门指南 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-2"> 入门指南 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../getting_started/install/index.html" title="安装" class="md-nav__link"> 安装 </a> </li> <li class="md-nav__item"> <a href="../../../getting_started/tutorial/index.html" title="教程" class="md-nav__link"> 教程 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4"/> <label class="md-nav__link" for="nav-2-4"> 示例数据集 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-2-4"> 示例数据集 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../getting_started/example_datasets/ontime/index.html" title="航班飞行数据" class="md-nav__link"> 航班飞行数据 </a> </li> <li class="md-nav__item"> <a href="../../../getting_started/example_datasets/nyc_taxi/index.html" title="纽约市出租车数据" class="md-nav__link"> 纽约市出租车数据 </a> </li> <li class="md-nav__item"> <a href="../../../getting_started/example_datasets/amplab_benchmark/index.html" title="AMPLab大数据基准测试" class="md-nav__link"> AMPLab大数据基准测试 </a> </li> <li class="md-nav__item"> <a href="../../../getting_started/example_datasets/wikistat/index.html" title="维基访问数据" class="md-nav__link"> 维基访问数据 </a> </li> <li class="md-nav__item"> <a href="../../../getting_started/example_datasets/criteo/index.html" title="Criteo TB级别点击日志" class="md-nav__link"> Criteo TB级别点击日志 </a> </li> <li class="md-nav__item"> <a href="../../../getting_started/example_datasets/star_schema/index.html" title="Star Schema基准测试" class="md-nav__link"> Star Schema基准测试 </a> </li> <li class="md-nav__item"> <a href="../../../getting_started/example_datasets/metrica/index.html" title="Yandex.Metrica" class="md-nav__link"> Yandex.Metrica </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3"/> <label class="md-nav__link" for="nav-3"> 客户端 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-3"> 客户端 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../interfaces/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/cli/index.html" title="命令行客户端接口" class="md-nav__link"> 命令行客户端接口 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/tcp/index.html" title="原生客户端接口 (TCP)" class="md-nav__link"> 原生客户端接口 (TCP) </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/http/index.html" title="HTTP 客户端接口" class="md-nav__link"> HTTP 客户端接口 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/formats/index.html" title="输入输出格式" class="md-nav__link"> 输入输出格式 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/jdbc/index.html" title="JDBC 驱动" class="md-nav__link"> JDBC 驱动 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/odbc/index.html" title="ODBC 驱动" class="md-nav__link"> ODBC 驱动 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/cpp/index.html" title="C ++客户端库" class="md-nav__link"> C ++客户端库 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9"/> <label class="md-nav__link" for="nav-3-9"> 第三方 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-3-9"> 第三方 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../interfaces/third-party/client_libraries/index.html" title="客户端库" class="md-nav__link"> 客户端库 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/third-party/integrations/index.html" title="集成" class="md-nav__link"> 集成 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/third-party/gui/index.html" title="可视界面" class="md-nav__link"> 可视界面 </a> </li> <li class="md-nav__item"> <a href="../../../interfaces/third-party/proxy/index.html" title="代理" class="md-nav__link"> 代理 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"/> <label class="md-nav__link" for="nav-4"> 数据类型 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-4"> 数据类型 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../data_types/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../data_types/int_uint/index.html" title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="md-nav__link"> UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64 </a> </li> <li class="md-nav__item"> <a href="../../../data_types/float/index.html" title="Float32, Float64" class="md-nav__link"> Float32, Float64 </a> </li> <li class="md-nav__item"> <a href="../../../data_types/decimal/index.html" title="Decimal" class="md-nav__link"> Decimal </a> </li> <li class="md-nav__item"> <a href="../../../data_types/boolean/index.html" title="Boolean values" class="md-nav__link"> Boolean values </a> </li> <li class="md-nav__item"> <a href="../../../data_types/string/index.html" title="String" class="md-nav__link"> String </a> </li> <li class="md-nav__item"> <a href="../../../data_types/fixedstring/index.html" title="FixedString(N)" class="md-nav__link"> FixedString(N) </a> </li> <li class="md-nav__item"> <a href="../../../data_types/uuid/index.html" title="UUID" class="md-nav__link"> UUID </a> </li> <li class="md-nav__item"> <a href="../../../data_types/date/index.html" title="Date" class="md-nav__link"> Date </a> </li> <li class="md-nav__item"> <a href="../../../data_types/datetime/index.html" title="DateTime" class="md-nav__link"> DateTime </a> </li> <li class="md-nav__item"> <a href="../../../data_types/enum/index.html" title="Enum" class="md-nav__link"> Enum </a> </li> <li class="md-nav__item"> <a href="../../../data_types/array/index.html" title="Array(T)" class="md-nav__link"> Array(T) </a> </li> <li class="md-nav__item"> <a href="../../../data_types/nested_data_structures/aggregatefunction/index.html" title="AggregateFunction(name, types_of_arguments...)" class="md-nav__link"> AggregateFunction(name, types_of_arguments...) </a> </li> <li class="md-nav__item"> <a href="../../../data_types/tuple/index.html" title="Tuple(T1, T2, ...)" class="md-nav__link"> Tuple(T1, T2, ...) </a> </li> <li class="md-nav__item"> <a href="../../../data_types/nullable/index.html" title="Nullable" class="md-nav__link"> Nullable </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-16" type="checkbox" id="nav-4-16"/> <label class="md-nav__link" for="nav-4-16"> 嵌套数据结构 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-4-16"> 嵌套数据结构 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../data_types/nested_data_structures/nested/index.html" title="Nested(Name1 Type1, Name2 Type2, ...)" class="md-nav__link"> Nested(Name1 Type1, Name2 Type2, ...) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-17" type="checkbox" id="nav-4-17"/> <label class="md-nav__link" for="nav-4-17"> 特殊数据类型 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-4-17"> 特殊数据类型 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../data_types/special_data_types/expression/index.html" title="Expression" class="md-nav__link"> Expression </a> </li> <li class="md-nav__item"> <a href="../../../data_types/special_data_types/set/index.html" title="Set" class="md-nav__link"> Set </a> </li> <li class="md-nav__item"> <a href="../../../data_types/special_data_types/nothing/index.html" title="Nothing" class="md-nav__link"> Nothing </a> </li> <li class="md-nav__item"> <a href="../../../data_types/special_data_types/interval/index.html" title="Interval" class="md-nav__link"> Interval </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-18" type="checkbox" id="nav-4-18"/> <label class="md-nav__link" for="nav-4-18"> Domain类型 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-4-18"> Domain类型 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../data_types/domains/overview/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../data_types/domains/ipv4/index.html" title="IPv4" class="md-nav__link"> IPv4 </a> </li> <li class="md-nav__item"> <a href="../../../data_types/domains/ipv6/index.html" title="IPv6" class="md-nav__link"> IPv6 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5"/> <label class="md-nav__link" for="nav-5"> 数据库引擎 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-5"> 数据库引擎 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../database_engines/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../database_engines/mysql/index.html" title="MySQL" class="md-nav__link"> MySQL </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6"/> <label class="md-nav__link" for="nav-6"> 表引擎 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-6"> 表引擎 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/table_engines/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2"/> <label class="md-nav__link" for="nav-6-2"> MergeTree </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-6-2"> MergeTree </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/table_engines/mergetree/index.html" title="MergeTree" class="md-nav__link"> MergeTree </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/replication/index.html" title="Data Replication" class="md-nav__link"> Data Replication </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/custom_partitioning_key/index.html" title="Custom Partitioning Key" class="md-nav__link"> Custom Partitioning Key </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/replacingmergetree/index.html" title="ReplacingMergeTree" class="md-nav__link"> ReplacingMergeTree </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/summingmergetree/index.html" title="SummingMergeTree" class="md-nav__link"> SummingMergeTree </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/aggregatingmergetree/index.html" title="AggregatingMergeTree" class="md-nav__link"> AggregatingMergeTree </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/collapsingmergetree/index.html" title="CollapsingMergeTree" class="md-nav__link"> CollapsingMergeTree </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/versionedcollapsingmergetree/index.html" title="VersionedCollapsingMergeTree" class="md-nav__link"> VersionedCollapsingMergeTree </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/graphitemergetree/index.html" title="GraphiteMergeTree" class="md-nav__link"> GraphiteMergeTree </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3"/> <label class="md-nav__link" for="nav-6-3"> Log </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-6-3"> Log </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/table_engines/log_family/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/stripelog/index.html" title="StripeLog" class="md-nav__link"> StripeLog </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/log/index.html" title="Log" class="md-nav__link"> Log </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/tinylog/index.html" title="TinyLog" class="md-nav__link"> TinyLog </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4"/> <label class="md-nav__link" for="nav-6-4"> 外部表引擎 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-6-4"> 外部表引擎 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/table_engines/kafka/index.html" title="Kafka" class="md-nav__link"> Kafka </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/mysql/index.html" title="MySQL" class="md-nav__link"> MySQL </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/jdbc/index.html" title="JDBC" class="md-nav__link"> JDBC </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/odbc/index.html" title="ODBC" class="md-nav__link"> ODBC </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/hdfs/index.html" title="HDFS" class="md-nav__link"> HDFS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5"/> <label class="md-nav__link" for="nav-6-5"> 其他表引擎 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-6-5"> 其他表引擎 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/table_engines/distributed/index.html" title="Distributed" class="md-nav__link"> Distributed </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/external_data/index.html" title="External data" class="md-nav__link"> External data </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/dictionary/index.html" title="Dictionary" class="md-nav__link"> Dictionary </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/merge/index.html" title="Merge" class="md-nav__link"> Merge </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/file/index.html" title="File" class="md-nav__link"> File </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/null/index.html" title="Null" class="md-nav__link"> Null </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/set/index.html" title="Set" class="md-nav__link"> Set </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/join/index.html" title="Join" class="md-nav__link"> Join </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/url/index.html" title="URL" class="md-nav__link"> URL </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/view/index.html" title="View" class="md-nav__link"> View </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/materializedview/index.html" title="MaterializedView" class="md-nav__link"> MaterializedView </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/memory/index.html" title="Memory" class="md-nav__link"> Memory </a> </li> <li class="md-nav__item"> <a href="../../../operations/table_engines/buffer/index.html" title="Buffer" class="md-nav__link"> Buffer </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked=""/> <label class="md-nav__link" for="nav-7"> SQL语法 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-7"> SQL语法 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../select/index.html" title="SELECT" class="md-nav__link"> SELECT </a> </li> <li class="md-nav__item"> <a href="../../insert_into/index.html" title="INSERT INTO" class="md-nav__link"> INSERT INTO </a> </li> <li class="md-nav__item"> <a href="../../create/index.html" title="CREATE" class="md-nav__link"> CREATE </a> </li> <li class="md-nav__item"> <a href="../../alter/index.html" title="ALTER" class="md-nav__link"> ALTER </a> </li> <li class="md-nav__item"> <a href="../../system/index.html" title="SYSTEM" class="md-nav__link"> SYSTEM </a> </li> <li class="md-nav__item"> <a href="../../show/index.html" title="SHOW" class="md-nav__link"> SHOW </a> </li> <li class="md-nav__item"> <a href="../../misc/index.html" title="其他类型的查询" class="md-nav__link"> 其他类型的查询 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-9" type="checkbox" id="nav-7-9"/> <label class="md-nav__link" for="nav-7-9"> 函数 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-9"> 函数 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../functions/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../functions/arithmetic_functions/index.html" title="算术函数" class="md-nav__link"> 算术函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/comparison_functions/index.html" title="比较函数" class="md-nav__link"> 比较函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/logical_functions/index.html" title="逻辑函数" class="md-nav__link"> 逻辑函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/type_conversion_functions/index.html" title="类型转换函数" class="md-nav__link"> 类型转换函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/date_time_functions/index.html" title="时间日期函数" class="md-nav__link"> 时间日期函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/string_functions/index.html" title="字符串函数" class="md-nav__link"> 字符串函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/string_search_functions/index.html" title="字符串搜索函数" class="md-nav__link"> 字符串搜索函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/string_replace_functions/index.html" title="字符串替换函数" class="md-nav__link"> 字符串替换函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/conditional_functions/index.html" title="条件函数 " class="md-nav__link"> 条件函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/math_functions/index.html" title="数学函数" class="md-nav__link"> 数学函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/rounding_functions/index.html" title="取整函数" class="md-nav__link"> 取整函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/array_functions/index.html" title="数组函数" class="md-nav__link"> 数组函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/splitting_merging_functions/index.html" title="字符串拆分合并函数" class="md-nav__link"> 字符串拆分合并函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/bit_functions/index.html" title="位操作函数" class="md-nav__link"> 位操作函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/bitmap_functions/index.html" title="位图函数" class="md-nav__link"> 位图函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/hash_functions/index.html" title="Hash函数" class="md-nav__link"> Hash函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/random_functions/index.html" title="随机函数" class="md-nav__link"> 随机函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/encoding_functions/index.html" title="编码函数" class="md-nav__link"> 编码函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/uuid_functions/index.html" title="UUID函数" class="md-nav__link"> UUID函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/url_functions/index.html" title="URL函数" class="md-nav__link"> URL函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/ip_address_functions/index.html" title="IP函数" class="md-nav__link"> IP函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/json_functions/index.html" title="JSON函数" class="md-nav__link"> JSON函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/higher_order_functions/index.html" title="高阶函数" class="md-nav__link"> 高阶函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/ext_dict_functions/index.html" title="字典函数" class="md-nav__link"> 字典函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/ym_dict_functions/index.html" title="Yandex.Metrica字典函数" class="md-nav__link"> Yandex.Metrica字典函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/in_functions/index.html" title="IN运算符相关函数" class="md-nav__link"> IN运算符相关函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/array_join/index.html" title="arrayJoin函数" class="md-nav__link"> arrayJoin函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/geo/index.html" title="GEO函数" class="md-nav__link"> GEO函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/functions_for_nulls/index.html" title="Nullable处理函数" class="md-nav__link"> Nullable处理函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/machine_learning_functions/index.html" title="机器学习函数" class="md-nav__link"> 机器学习函数 </a> </li> <li class="md-nav__item"> <a href="../../functions/introspection/index.html" title="Introspection" class="md-nav__link"> Introspection </a> </li> <li class="md-nav__item"> <a href="../../functions/other_functions/index.html" title="其他函数" class="md-nav__link"> 其他函数 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-10" type="checkbox" id="nav-7-10"/> <label class="md-nav__link" for="nav-7-10"> 聚合函数 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-10"> 聚合函数 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../agg_functions/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../agg_functions/reference/index.html" title="函数列表" class="md-nav__link"> 函数列表 </a> </li> <li class="md-nav__item"> <a href="../../agg_functions/combinators/index.html" title="聚合函数组合子" class="md-nav__link"> 聚合函数组合子 </a> </li> <li class="md-nav__item"> <a href="../../agg_functions/parametric_functions/index.html" title="参数化聚合函数" class="md-nav__link"> 参数化聚合函数 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-11" type="checkbox" id="nav-7-11"/> <label class="md-nav__link" for="nav-7-11"> 表引擎函数 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-11"> 表引擎函数 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../table_functions/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../table_functions/file/index.html" title="file" class="md-nav__link"> file </a> </li> <li class="md-nav__item"> <a href="../../table_functions/merge/index.html" title="merge" class="md-nav__link"> merge </a> </li> <li class="md-nav__item"> <a href="../../table_functions/numbers/index.html" title="numbers" class="md-nav__link"> numbers </a> </li> <li class="md-nav__item"> <a href="../../table_functions/remote/index.html" title="remote" class="md-nav__link"> remote </a> </li> <li class="md-nav__item"> <a href="../../table_functions/url/index.html" title="url" class="md-nav__link"> url </a> </li> <li class="md-nav__item"> <a href="../../table_functions/mysql/index.html" title="mysql" class="md-nav__link"> mysql </a> </li> <li class="md-nav__item"> <a href="../../table_functions/jdbc/index.html" title="jdbc" class="md-nav__link"> jdbc </a> </li> <li class="md-nav__item"> <a href="../../table_functions/odbc/index.html" title="odbc" class="md-nav__link"> odbc </a> </li> <li class="md-nav__item"> <a href="../../table_functions/hdfs/index.html" title="hdfs" class="md-nav__link"> hdfs </a> </li> <li class="md-nav__item"> <a href="../../table_functions/input/index.html" title="input" class="md-nav__link"> input </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-12" type="checkbox" id="nav-7-12" checked=""/> <label class="md-nav__link" for="nav-7-12"> 字典 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-7-12"> 字典 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-12-2" type="checkbox" id="nav-7-12-2" checked=""/> <label class="md-nav__link" for="nav-7-12-2"> 外部字典 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="3"> <label class="md-nav__title" for="nav-7-12-2"> 外部字典 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../external_dicts/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../external_dicts_dict/index.html" title="配置外部字典" class="md-nav__link"> 配置外部字典 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc"/> <label class="md-nav__link md-nav__link--active" for="toc"> 字典的内存布局 </label> <a href="index.html" title="字典的内存布局" class="md-nav__link md-nav__link--active"> <strong>字典的内存布局</strong> </a> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title" for="toc">目录</label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="index.html#ways-to-store-dictionaries-in-memory" title="Ways to Store Dictionaries in Memory" class="md-nav__link"> Ways to Store Dictionaries in Memory </a> <nav class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="index.html#flat" title="flat" class="md-nav__link"> flat </a> </li> <li class="md-nav__item"> <a href="index.html#dicts-external_dicts_dict_layout-hashed" title="hashed" class="md-nav__link"> hashed </a> </li> <li class="md-nav__item"> <a href="index.html#dicts-external_dicts_dict_layout-sparse_hashed" title="sparse_hashed" class="md-nav__link"> sparse_hashed </a> </li> <li class="md-nav__item"> <a href="index.html#complex-key-hashed" title="complex_key_hashed" class="md-nav__link"> complex_key_hashed </a> </li> <li class="md-nav__item"> <a href="index.html#range-hashed" title="range_hashed" class="md-nav__link"> range_hashed </a> </li> <li class="md-nav__item"> <a href="index.html#cache" title="cache" class="md-nav__link"> cache </a> </li> <li class="md-nav__item"> <a href="index.html#complex-key-cache" title="complex_key_cache" class="md-nav__link"> complex_key_cache </a> </li> <li class="md-nav__item"> <a href="index.html#ip-trie" title="ip_trie" class="md-nav__link"> ip_trie </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../external_dicts_dict_lifetime/index.html" title="字典的刷新策略" class="md-nav__link"> 字典的刷新策略 </a> </li> <li class="md-nav__item"> <a href="../external_dicts_dict_sources/index.html" title="字典的外部数据源" class="md-nav__link"> 字典的外部数据源 </a> </li> <li class="md-nav__item"> <a href="../external_dicts_dict_structure/index.html" title="字典的键和字段值" class="md-nav__link"> 字典的键和字段值 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../internal_dicts/index.html" title="内部字典" class="md-nav__link"> 内部字典 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../operators/index.html" title="操作符" class="md-nav__link"> 操作符 </a> </li> <li class="md-nav__item"> <a href="../../syntax/index.html" title="语法说明" class="md-nav__link"> 语法说明 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8"/> <label class="md-nav__link" for="nav-8"> 运维 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-8"> 运维 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../operations/requirements/index.html" title="环境要求" class="md-nav__link"> 环境要求 </a> </li> <li class="md-nav__item"> <a href="../../../operations/monitoring/index.html" title="监控" class="md-nav__link"> 监控 </a> </li> <li class="md-nav__item"> <a href="../../../operations/troubleshooting/index.html" title="故障排查" class="md-nav__link"> 故障排查 </a> </li> <li class="md-nav__item"> <a href="../../../operations/tips/index.html" title="使用建议" class="md-nav__link"> 使用建议 </a> </li> <li class="md-nav__item"> <a href="../../../operations/update/index.html" title="版本升级" class="md-nav__link"> 版本升级 </a> </li> <li class="md-nav__item"> <a href="../../../operations/access_rights/index.html" title="访问权限控制" class="md-nav__link"> 访问权限控制 </a> </li> <li class="md-nav__item"> <a href="../../../operations/backup/index.html" title="数据备份" class="md-nav__link"> 数据备份 </a> </li> <li class="md-nav__item"> <a href="../../../operations/configuration_files/index.html" title="配置文件" class="md-nav__link"> 配置文件 </a> </li> <li class="md-nav__item"> <a href="../../../operations/quotas/index.html" title="配额" class="md-nav__link"> 配额 </a> </li> <li class="md-nav__item"> <a href="../../../operations/system_tables/index.html" title="系统表" class="md-nav__link"> 系统表 </a> </li> <li class="md-nav__item"> <a href="../../../operations/performance_test/index.html" title="Testing Hardware" class="md-nav__link"> Testing Hardware </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-13" type="checkbox" id="nav-8-13"/> <label class="md-nav__link" for="nav-8-13"> Server参数配置 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-13"> Server参数配置 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/server_settings/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../operations/server_settings/settings/index.html" title="Server参数说明" class="md-nav__link"> Server参数说明 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-14" type="checkbox" id="nav-8-14"/> <label class="md-nav__link" for="nav-8-14"> Settings配置 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-14"> Settings配置 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/settings/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../operations/settings/permissions_for_queries/index.html" title="查询权限管理" class="md-nav__link"> 查询权限管理 </a> </li> <li class="md-nav__item"> <a href="../../../operations/settings/query_complexity/index.html" title="查询复杂性的限制" class="md-nav__link"> 查询复杂性的限制 </a> </li> <li class="md-nav__item"> <a href="../../../operations/settings/settings/index.html" title="Setting列表" class="md-nav__link"> Setting列表 </a> </li> <li class="md-nav__item"> <a href="../../../operations/settings/settings_profiles/index.html" title="Setting配置组" class="md-nav__link"> Setting配置组 </a> </li> <li class="md-nav__item"> <a href="../../../operations/settings/settings_users/index.html" title="用户配置" class="md-nav__link"> 用户配置 </a> </li> <li class="md-nav__item"> <a href="../../../operations/settings/constraints_on_settings/index.html" title="Settings的约束" class="md-nav__link"> Settings的约束 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-15" type="checkbox" id="nav-8-15"/> <label class="md-nav__link" for="nav-8-15"> 常用工具 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="2"> <label class="md-nav__title" for="nav-8-15"> 常用工具 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../operations/utils/index.html" title="介绍" class="md-nav__link"> 介绍 </a> </li> <li class="md-nav__item"> <a href="../../../operations/utils/clickhouse-copier/index.html" title="clickhouse-copier" class="md-nav__link"> clickhouse-copier </a> </li> <li class="md-nav__item"> <a href="../../../operations/utils/clickhouse-local/index.html" title="clickhouse-local" class="md-nav__link"> clickhouse-local </a> </li> <li class="md-nav__item"> <a href="../../../operations/utils/clickhouse-benchmark/index.html" title="clickhouse-benchmark" class="md-nav__link"> clickhouse-benchmark </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9"/> <label class="md-nav__link" for="nav-9"> 常见问题 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-9"> 常见问题 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../faq/general/index.html" title="一般的问题" class="md-nav__link"> 一般的问题 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10"/> <label class="md-nav__link" for="nav-10"> 开发者指南 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-10"> 开发者指南 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../development/architecture/index.html" title="ClickHouse架构概述" class="md-nav__link"> ClickHouse架构概述 </a> </li> <li class="md-nav__item"> <a href="../../../development/build/index.html" title="如何在Linux中编译ClickHouse" class="md-nav__link"> 如何在Linux中编译ClickHouse </a> </li> <li class="md-nav__item"> <a href="../../../development/build_osx/index.html" title="如何在Mac OS X中编译ClickHouse" class="md-nav__link"> 如何在Mac OS X中编译ClickHouse </a> </li> <li class="md-nav__item"> <a href="../../../development/build_cross_osx/index.html" title="如何在Linux中编译Mac OS X ClickHouse" class="md-nav__link"> 如何在Linux中编译Mac OS X ClickHouse </a> </li> <li class="md-nav__item"> <a href="../../../development/style/index.html" title="如何编写C++代码" class="md-nav__link"> 如何编写C++代码 </a> </li> <li class="md-nav__item"> <a href="../../../development/tests/index.html" title="如何运行ClickHouse测试" class="md-nav__link"> 如何运行ClickHouse测试 </a> </li> <li class="md-nav__item"> <a href="../../../development/developer_instruction/index.html" title="开发者指南" class="md-nav__link"> 开发者指南 </a> </li> <li class="md-nav__item"> <a href="../../../development/contrib/index.html" title="使用的第三方库" class="md-nav__link"> 使用的第三方库 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11"/> <label class="md-nav__link" for="nav-11"> 新功能特性 </label> <nav class="md-nav" data-md-component="collapsible" data-md-level="1"> <label class="md-nav__title" for="nav-11"> 新功能特性 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../../roadmap/index.html" title="路线图" class="md-nav__link"> 路线图 </a> </li> <li class="md-nav__item"> <a href="../../../changelog/index.html" title="更新日志" class="md-nav__link"> 更新日志 </a> </li> <li class="md-nav__item"> <a href="../../../security_changelog/index.html" title="安全更改日志" class="md-nav__link"> 安全更改日志 </a> </li> </ul> </nav> </li> </ul> <ul id="md-extra-nav" class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--active"> 发布: <span class="md-selector"> <select id="releases-selector"> <option value="">最新</option> <option value="v19.17">v19.17</option> </select><span id="releases-selector-after">&nbsp;▾</span> </span> </li> <li class="md-nav__item md-nav__item--active"> <a href="https://clickhouse.yandex/docs/zh/single/" class="md-nav__link md-nav__link--active">单页版本</a> </li> <li class="md-nav__item md-nav__item--active"> <a href="https://clickhouse.yandex/docs/zh/single/clickhouse_zh.pdf" class="md-nav__link md-nav__link--active">PDF版本</a> </li> <li class="md-nav__item md-nav__item--active"> <a href="https://github.com/ClickHouse/ClickHouse/" rel="external nofollow" target="_blank" class="md-nav__link"> ClickHouse源代码 </a> </li> <li class="md-nav__item md-nav__item--active"> <span id="md-sidebar-flags" class="md-nav__link"> <a class="md-alt-lang" href="https://clickhouse.yandex/docs/en/query_language/dicts/external_dicts_dict_layout/" class="md-flex__ellipsis md-header-nav__title" title="English"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" preserveAspectRatio="none"> <clipPath id="t"> <path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"></path> </clipPath> <path fill="#00247d" d="M0,0 v30 h60 v-30 z"></path> <path stroke="#fff" stroke-width="6" d="M0,0 L60,30 M60,0 L0,30"></path> <path clip-path="url(#t)" stroke="#cf142b" stroke-width="4" d="M0,0 L60,30 M60,0 L0,30"></path> <path stroke="#fff" stroke-width="10" d="M30,0 v30 M0,15 h60"></path> <path stroke="#cf142b" stroke-width="6" d="M30,0 v30 M0,15 h60"></path> </svg> </a> <a class="md-alt-lang" href="https://clickhouse.yandex/docs/ru/query_language/dicts/external_dicts_dict_layout/" class="md-flex__ellipsis md-header-nav__title" title="Russian"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 6" preserveAspectRatio="none"> <rect fill="#fff" width="9" height="3"></rect> <rect fill="#d52b1e" y="3" width="9" height="3"></rect> <rect fill="#0039a6" y="2" width="9" height="2"></rect> </svg> </a> <a class="md-alt-lang md-current-lang" href="index.html" class="md-flex__ellipsis md-header-nav__title" title="Chinese"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 30 20" preserveAspectRatio="none"> <defs> <path id="s" fill="#ffde00" d="M0,-1 0.587785,0.809017 -0.951057,-0.309017H0.951057L-0.587785,0.809017z"></path> </defs> <rect width="30" height="20" fill="#de2910"></rect> <use xlink:href="#s" transform="translate(5,5) scale(3)"></use> <use xlink:href="#s" transform="translate(10,2) rotate(23.036243)"></use> <use xlink:href="#s" transform="translate(12,4) rotate(45.869898)"></use> <use xlink:href="#s" transform="translate(12,7) rotate(69.945396)"></use> <use xlink:href="#s" transform="translate(10,9) rotate(20.659808)"></use> </svg> </a> <a class="md-alt-lang" href="https://clickhouse.yandex/docs/ja/query_language/dicts/external_dicts_dict_layout/" class="md-flex__ellipsis md-header-nav__title" title="Japanese"> <!--?xml version="1.0" encoding="UTF-8"?--> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="90px" height="60px" viewBox="0 0 90 60" version="1.1"> <g id="surface1"> <rect x="0" y="0" width="90" height="60" style="fill:rgb(62.7451%,62.7451%,62.7451%);fill-opacity:1;stroke:none;"></rect> <path style=" stroke:none;fill-rule:nonzero;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 0.601562 0.601562 L 89.398438 0.601562 L 89.398438 59.398438 L 0.601562 59.398438 Z M 0.601562 0.601562 "></path> <path style=" stroke:none;fill-rule:nonzero;fill:rgb(74.509805%,0%,14.901961%);fill-opacity:1;" d="M 63 30 C 63 39.941406 54.941406 48 45 48 C 35.058594 48 27 39.941406 27 30 C 27 20.058594 35.058594 12 45 12 C 54.941406 12 63 20.058594 63 30 Z M 63 30 "></path> </g> </svg> </a> <a class="md-alt-lang" href="https://clickhouse.yandex/docs/fa/query_language/dicts/external_dicts_dict_layout/" class="md-flex__ellipsis md-header-nav__title" title="Farsi"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 630 360" preserveAspectRatio="none"> <rect width="630" height="360" fill="#da0000"></rect> <rect width="630" height="240" fill="#fff"></rect> <rect width="630" height="120" fill="#239f40"></rect> <g transform="translate(8.4,100.4)"> <g id="tb4"> <g id="tb1" fill="none" stroke="#fff" stroke-width="2"> <path id="tbp1" d="M0,1H26M1,10V5H9V9H17V5H12M4,9H6M26,9H21V5H29M29,0V9H37V0M33,0V9" transform="scale(1.4)"></path> <path id="tbp2" d="M0,7H9M10,7H19" transform="scale(2.8)"></path> <use xlink:href="#tbp2" y="120"></use> <use xlink:href="#tbp1" y="145.2"></use> </g> <g id="tb3"> <use xlink:href="#tb1" x="56"></use> <use xlink:href="#tb1" x="112"></use> <use xlink:href="#tb1" x="168"></use> </g> </g> <use xlink:href="#tb3" x="168"></use> <use xlink:href="#tb4" x="392"></use> </g> <g fill="#da0000" transform="matrix(45,0,0,45,315,180)"> <g id="emblem_half"> <path d="M-0.54815,0.83638A0.912046,0.912046 0 0,0 0.328544,-0.722384A1,1 0 0,1 -0.54815,0.83638"></path> <path d="M0.618339,0.661409A0.763932,0.763932 0 0,0 0.421644,-0.741049A1,1 0 0,1 0.618339,0.661409"></path> <path d="M0,1 -0.05,0 0,-0.787278A0.309995,0.309995 0 0,0 0.118034,-0.688191V-0.100406L0.077809,0.892905z"></path> <path d="M-0.02,-0.85 0,-0.831217A0.14431,0.14431 0 0,0 0.252075,-0.967708A0.136408,0.136408 0 0,1 0,-0.924634"></path> </g> <use xlink:href="#emblem_half" transform="scale(-1,1)"></use> </g> </svg> </a> </span> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary"> <label class="md-nav__title" for="toc">目录</label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="index.html#ways-to-store-dictionaries-in-memory" title="Ways to Store Dictionaries in Memory" class="md-nav__link"> Ways to Store Dictionaries in Memory </a> <nav class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="index.html#flat" title="flat" class="md-nav__link"> flat </a> </li> <li class="md-nav__item"> <a href="index.html#dicts-external_dicts_dict_layout-hashed" title="hashed" class="md-nav__link"> hashed </a> </li> <li class="md-nav__item"> <a href="index.html#dicts-external_dicts_dict_layout-sparse_hashed" title="sparse_hashed" class="md-nav__link"> sparse_hashed </a> </li> <li class="md-nav__item"> <a href="index.html#complex-key-hashed" title="complex_key_hashed" class="md-nav__link"> complex_key_hashed </a> </li> <li class="md-nav__item"> <a href="index.html#range-hashed" title="range_hashed" class="md-nav__link"> range_hashed </a> </li> <li class="md-nav__item"> <a href="index.html#cache" title="cache" class="md-nav__link"> cache </a> </li> <li class="md-nav__item"> <a href="index.html#complex-key-cache" title="complex_key_cache" class="md-nav__link"> complex_key_cache </a> </li> <li class="md-nav__item"> <a href="index.html#ip-trie" title="ip_trie" class="md-nav__link"> ip_trie </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content"> <article class="md-content__inner md-typeset"> <a href="https://github.com/ClickHouse/ClickHouse/edit/master/docs/zh/query_language/dicts/external_dicts_dict_layout.md" title="编辑此页" class="md-icon md-content__icon" rel="external nofollow"></a> <div id="content"> <h1 id="dicts-external_dicts_dict_layout">Storing Dictionaries in Memory<a class="headerlink" href="index.html#dicts-external_dicts_dict_layout" title="Permanent link">&para;</a></h1> <p>There are a variety of ways to store dictionaries in memory.</p> <p>We recommend <a href="index.html#flat">flat</a>, <a href="index.html#dicts-external_dicts_dict_layout-hashed">hashed</a> and <a href="index.html#complex-key-hashed">complex_key_hashed</a>. which provide optimal processing speed.</p> <p>Caching is not recommended because of potentially poor performance and difficulties in selecting optimal parameters. Read more in the section &#34;<a href="index.html#cache">cache</a>&#34;.</p> <p>There are several ways to improve dictionary performance:</p> <ul> <li>Call the function for working with the dictionary after <code>GROUP BY</code>.</li> <li>Mark attributes to extract as injective. An attribute is called injective if different attribute values correspond to different keys. So when <code>GROUP BY</code> uses a function that fetches an attribute value by the key, this function is automatically taken out of <code>GROUP BY</code>.</li> </ul> <p>ClickHouse generates an exception for errors with dictionaries. Examples of errors:</p> <ul> <li>The dictionary being accessed could not be loaded.</li> <li>Error querying a <code>cached</code> dictionary.</li> </ul> <p>You can view the list of external dictionaries and their statuses in the <code>system.dictionaries</code> table.</p> <p>The configuration looks like this:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;yandex&gt;</span>
    <span class="nt">&lt;dictionary&gt;</span>
        ...
        <span class="nt">&lt;layout&gt;</span>
            <span class="nt">&lt;layout_type&gt;</span>
                <span class="c">&lt;!-- layout settings --&gt;</span>
            <span class="nt">&lt;/layout_type&gt;</span>
        <span class="nt">&lt;/layout&gt;</span>
        ...
    <span class="nt">&lt;/dictionary&gt;</span>
<span class="nt">&lt;/yandex&gt;</span>
</pre></div> <p>in case of <a href="../../create/index.html#create-dictionary-query">DDL-query</a>, equal configuration will looks like</p> <div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">DICTIONARY</span> <span class="p">(...)</span>
<span class="p">...</span>
<span class="n">LAYOUT</span><span class="p">(</span><span class="n">LAYOUT_TYPE</span><span class="p">(</span><span class="n">param</span> <span class="n">value</span><span class="p">))</span> <span class="c1">-- layout settings</span>
<span class="p">...</span>
</pre></div> <a class="dashingAutolink" name="autolink-103"></a><a class="dashAnchor" name="//apple_ref/cpp/Query/Ways%20to%20Store%20Dictionaries%20in%20Memory"></a><h2 id="ways-to-store-dictionaries-in-memory">Ways to Store Dictionaries in Memory<a class="headerlink" href="index.html#ways-to-store-dictionaries-in-memory" title="Permanent link">&para;</a></h2> <ul> <li><a href="index.html#flat">flat</a></li> <li><a href="index.html#dicts-external_dicts_dict_layout-hashed">hashed</a></li> <li><a href="index.html#dicts-external_dicts_dict_layout-sparse_hashed">sparse_hashed</a></li> <li><a href="index.html#cache">cache</a></li> <li><a href="index.html#range-hashed">range_hashed</a></li> <li><a href="index.html#complex-key-hashed">complex_key_hashed</a></li> <li><a href="index.html#complex-key-cache">complex_key_cache</a></li> <li><a href="index.html#ip-trie">ip_trie</a></li> </ul> <h3 id="flat">flat<a class="headerlink" href="index.html#flat" title="Permanent link">&para;</a></h3> <p>The dictionary is completely stored in memory in the form of flat arrays. How much memory does the dictionary use? The amount is proportional to the size of the largest key (in space used).</p> <p>The dictionary key has the <code>UInt64</code> type and the value is limited to 500,000. If a larger key is discovered when creating the dictionary, ClickHouse throws an exception and does not create the dictionary.</p> <p>All types of sources are supported. When updating, data (from a file or from a table) is read in its entirety.</p> <p>This method provides the best performance among all available methods of storing the dictionary.</p> <p>Configuration example:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;layout&gt;</span>
  <span class="nt">&lt;flat</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</pre></div> <p>or</p> <div class="codehilite"><pre><span></span><span class="n">LAYOUT</span><span class="p">(</span><span class="n">FLAT</span><span class="p">())</span>
</pre></div> <h3 id="dicts-external_dicts_dict_layout-hashed">hashed<a class="headerlink" href="index.html#dicts-external_dicts_dict_layout-hashed" title="Permanent link">&para;</a></h3> <p>The dictionary is completely stored in memory in the form of a hash table. The dictionary can contain any number of elements with any identifiers In practice, the number of keys can reach tens of millions of items.</p> <p>All types of sources are supported. When updating, data (from a file or from a table) is read in its entirety.</p> <p>Configuration example:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;layout&gt;</span>
  <span class="nt">&lt;hashed</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</pre></div> <p>or</p> <div class="codehilite"><pre><span></span><span class="n">LAYOUT</span><span class="p">(</span><span class="n">HASHED</span><span class="p">())</span>
</pre></div> <h3 id="dicts-external_dicts_dict_layout-sparse_hashed">sparse_hashed<a class="headerlink" href="index.html#dicts-external_dicts_dict_layout-sparse_hashed" title="Permanent link">&para;</a></h3> <p>Similar to <code>hashed</code>, but uses less memory in favor more CPU usage.</p> <p>Configuration example:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;layout&gt;</span>
  <span class="nt">&lt;sparse_hashed</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</pre></div> <div class="codehilite"><pre><span></span><span class="n">LAYOUT</span><span class="p">(</span><span class="n">SPARSE_HASHED</span><span class="p">())</span>
</pre></div> <h3 id="complex-key-hashed">complex_key_hashed<a class="headerlink" href="index.html#complex-key-hashed" title="Permanent link">&para;</a></h3> <p>This type of storage is for use with composite <a href="../external_dicts_dict_structure/index.html">keys</a>. Similar to <code>hashed</code>.</p> <p>Configuration example:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;layout&gt;</span>
  <span class="nt">&lt;complex_key_hashed</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</pre></div> <div class="codehilite"><pre><span></span><span class="n">LAYOUT</span><span class="p">(</span><span class="n">COMPLEX_KEY_HASHED</span><span class="p">())</span>
</pre></div> <h3 id="range-hashed">range_hashed<a class="headerlink" href="index.html#range-hashed" title="Permanent link">&para;</a></h3> <p>The dictionary is stored in memory in the form of a hash table with an ordered array of ranges and their corresponding values.</p> <p>This storage method works the same way as hashed and allows using date/time (arbitrary numeric type) ranges in addition to the key.</p> <p>Example: The table contains discounts for each advertiser in the format:</p> <div class="codehilite"><pre><span></span>+---------------|---------------------|-------------------|--------+
| advertiser id | discount start date | discount end date | amount |
+===============+=====================+===================+========+
| 123           | 2015-01-01          | 2015-01-15        | 0.15   |
+---------------|---------------------|-------------------|--------+
| 123           | 2015-01-16          | 2015-01-31        | 0.25   |
+---------------|---------------------|-------------------|--------+
| 456           | 2015-01-01          | 2015-01-15        | 0.05   |
+---------------|---------------------|-------------------|--------+
</pre></div> <p>To use a sample for date ranges, define the <code>range_min</code> and <code>range_max</code> elements in the <a href="../external_dicts_dict_structure/index.html">structure</a>. These elements must contain elements <code>name</code> and<code>type</code> (if <code>type</code> is not specified, the default type will be used - Date). <code>type</code> can be any numeric type (Date / DateTime / UInt64 / Int32 / others).</p> <p>Example:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;structure&gt;</span>
    <span class="nt">&lt;id&gt;</span>
        <span class="nt">&lt;name&gt;</span>Id<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;range_min&gt;</span>
        <span class="nt">&lt;name&gt;</span>first<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;type&gt;</span>Date<span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;/range_min&gt;</span>
    <span class="nt">&lt;range_max&gt;</span>
        <span class="nt">&lt;name&gt;</span>last<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;type&gt;</span>Date<span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;/range_max&gt;</span>
    ...
</pre></div> <p>or</p> <div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">DICTIONARY</span> <span class="n">somedict</span> <span class="p">(</span>
    <span class="n">id</span> <span class="n">UInt64</span><span class="p">,</span>
    <span class="k">first</span> <span class="nb">Date</span><span class="p">,</span>
    <span class="k">last</span> <span class="nb">Date</span>
<span class="p">)</span>
<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">id</span>
<span class="n">LAYOUT</span><span class="p">(</span><span class="n">RANGE_HASHED</span><span class="p">())</span>
<span class="n">RANGE</span><span class="p">(</span><span class="k">MIN</span> <span class="k">first</span> <span class="k">MAX</span> <span class="k">last</span><span class="p">)</span>
</pre></div> <p>To work with these dictionaries, you need to pass an additional argument to the <code>dictGetT</code> function, for which a range is selected:</p> <div class="codehilite"><pre><span></span><span class="n">dictGetT</span><span class="p">(</span><span class="s1">&#39;dict_name&#39;</span><span class="p">,</span> <span class="s1">&#39;attr_name&#39;</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="nb">date</span><span class="p">)</span>
</pre></div> <p>This function returns the value for the specified <code>id</code>s and the date range that includes the passed date.</p> <p>Details of the algorithm:</p> <ul> <li>If the <code>id</code> is not found or a range is not found for the <code>id</code>, it returns the default value for the dictionary.</li> <li>If there are overlapping ranges, you can use any.</li> <li>If the range delimiter is <code>NULL</code> or an invalid date (such as 1900-01-01 or 2039-01-01), the range is left open. The range can be open on both sides.</li> </ul> <p>Configuration example:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;yandex&gt;</span>
        <span class="nt">&lt;dictionary&gt;</span>

                ...

                <span class="nt">&lt;layout&gt;</span>
                        <span class="nt">&lt;range_hashed</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;/layout&gt;</span>

                <span class="nt">&lt;structure&gt;</span>
                        <span class="nt">&lt;id&gt;</span>
                                <span class="nt">&lt;name&gt;</span>Abcdef<span class="nt">&lt;/name&gt;</span>
                        <span class="nt">&lt;/id&gt;</span>
                        <span class="nt">&lt;range_min&gt;</span>
                                <span class="nt">&lt;name&gt;</span>StartTimeStamp<span class="nt">&lt;/name&gt;</span>
                                <span class="nt">&lt;type&gt;</span>UInt64<span class="nt">&lt;/type&gt;</span>
                        <span class="nt">&lt;/range_min&gt;</span>
                        <span class="nt">&lt;range_max&gt;</span>
                                <span class="nt">&lt;name&gt;</span>EndTimeStamp<span class="nt">&lt;/name&gt;</span>
                                <span class="nt">&lt;type&gt;</span>UInt64<span class="nt">&lt;/type&gt;</span>
                        <span class="nt">&lt;/range_max&gt;</span>
                        <span class="nt">&lt;attribute&gt;</span>
                                <span class="nt">&lt;name&gt;</span>XXXType<span class="nt">&lt;/name&gt;</span>
                                <span class="nt">&lt;type&gt;</span>String<span class="nt">&lt;/type&gt;</span>
                                <span class="nt">&lt;null_value</span> <span class="nt">/&gt;</span>
                        <span class="nt">&lt;/attribute&gt;</span>
                <span class="nt">&lt;/structure&gt;</span>

        <span class="nt">&lt;/dictionary&gt;</span>
<span class="nt">&lt;/yandex&gt;</span>
</pre></div> <p>or</p> <div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">DICTIONARY</span> <span class="n">somedict</span><span class="p">(</span>
    <span class="n">Abcdef</span> <span class="n">UInt64</span><span class="p">,</span>
    <span class="n">StartTimeStamp</span> <span class="n">UInt64</span><span class="p">,</span>
    <span class="n">EndTimeStamp</span> <span class="n">UInt64</span><span class="p">,</span>
    <span class="n">XXXType</span> <span class="n">String</span> <span class="k">DEFAULT</span> <span class="s1">&#39;&#39;</span>
<span class="p">)</span>
<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">Abcdef</span>
<span class="n">RANGE</span><span class="p">(</span><span class="k">MIN</span> <span class="n">StartTimeStamp</span> <span class="k">MAX</span> <span class="n">EndTimeStamp</span><span class="p">)</span>
</pre></div> <h3 id="cache">cache<a class="headerlink" href="index.html#cache" title="Permanent link">&para;</a></h3> <p>The dictionary is stored in a cache that has a fixed number of cells. These cells contain frequently used elements.</p> <p>When searching for a dictionary, the cache is searched first. For each block of data, all keys that are not found in the cache or are outdated are requested from the source using <code>SELECT attrs... FROM db.table WHERE id IN (k1, k2, ...)</code>. The received data is then written to the cache.</p> <p>For cache dictionaries, the expiration <a href="../external_dicts_dict_lifetime/index.html">lifetime</a> of data in the cache can be set. If more time than <code>lifetime</code> has passed since loading the data in a cell, the cell&#39;s value is not used, and it is re-requested the next time it needs to be used. This is the least effective of all the ways to store dictionaries. The speed of the cache depends strongly on correct settings and the usage scenario. A cache type dictionary performs well only when the hit rates are high enough (recommended 99% and higher). You can view the average hit rate in the <code>system.dictionaries</code> table.</p> <p>To improve cache performance, use a subquery with <code>LIMIT</code>, and call the function with the dictionary externally.</p> <p>Supported <a href="../external_dicts_dict_sources/index.html">sources</a>: MySQL, ClickHouse, executable, HTTP.</p> <p>Example of settings:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;layout&gt;</span>
    <span class="nt">&lt;cache&gt;</span>
        <span class="c">&lt;!-- The size of the cache, in number of cells. Rounded up to a power of two. --&gt;</span>
        <span class="nt">&lt;size_in_cells&gt;</span>1000000000<span class="nt">&lt;/size_in_cells&gt;</span>
    <span class="nt">&lt;/cache&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</pre></div> <p>or</p> <div class="codehilite"><pre><span></span><span class="n">LAYOUT</span><span class="p">(</span><span class="k">CACHE</span><span class="p">(</span><span class="n">SIZE_IN_CELLS</span> <span class="mi">1000000000</span><span class="p">))</span>
</pre></div> <p>Set a large enough cache size. You need to experiment to select the number of cells:</p> <ol> <li>Set some value.</li> <li>Run queries until the cache is completely full.</li> <li>Assess memory consumption using the <code>system.dictionaries</code> table.</li> <li>Increase or decrease the number of cells until the required memory consumption is reached.</li> </ol> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Do not use ClickHouse as a source, because it is slow to process queries with random reads.</p> </div> <h3 id="complex-key-cache">complex_key_cache<a class="headerlink" href="index.html#complex-key-cache" title="Permanent link">&para;</a></h3> <p>This type of storage is for use with composite <a href="../external_dicts_dict_structure/index.html">keys</a>. Similar to <code>cache</code>.</p> <h3 id="ip-trie">ip_trie<a class="headerlink" href="index.html#ip-trie" title="Permanent link">&para;</a></h3> <p>This type of storage is for mapping network prefixes (IP addresses) to metadata such as ASN.</p> <p>Example: The table contains network prefixes and their corresponding AS number and country code:</p> <div class="codehilite"><pre><span></span>  +-----------------|-------|--------+
  | prefix          | asn   | cca2   |
  +=================+=======+========+
  | 202.79.32.0/20  | 17501 | NP     |
  +-----------------|-------|--------+
  | 2620:0:870::/48 | 3856  | US     |
  +-----------------|-------|--------+
  | 2a02:6b8:1::/48 | 13238 | RU     |
  +-----------------|-------|--------+
  | 2001:db8::/32   | 65536 | ZZ     |
  +-----------------|-------|--------+
</pre></div> <p>When using this type of layout, the structure must have a composite key.</p> <p>Example:</p> <div class="codehilite"><pre><span></span><span class="nt">&lt;structure&gt;</span>
    <span class="nt">&lt;key&gt;</span>
        <span class="nt">&lt;attribute&gt;</span>
            <span class="nt">&lt;name&gt;</span>prefix<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;type&gt;</span>String<span class="nt">&lt;/type&gt;</span>
        <span class="nt">&lt;/attribute&gt;</span>
    <span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;attribute&gt;</span>
            <span class="nt">&lt;name&gt;</span>asn<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;type&gt;</span>UInt32<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;null_value</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/attribute&gt;</span>
    <span class="nt">&lt;attribute&gt;</span>
            <span class="nt">&lt;name&gt;</span>cca2<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;type&gt;</span>String<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;null_value&gt;</span>??<span class="nt">&lt;/null_value&gt;</span>
    <span class="nt">&lt;/attribute&gt;</span>
    ...
</pre></div> <p>or</p> <div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">DICTIONARY</span> <span class="n">somedict</span> <span class="p">(</span>
    <span class="k">prefix</span> <span class="n">String</span><span class="p">,</span>
    <span class="n">asn</span> <span class="n">UInt32</span><span class="p">,</span>
    <span class="n">cca2</span> <span class="n">String</span> <span class="k">DEFAULT</span> <span class="s1">&#39;??&#39;</span>
<span class="p">)</span>
<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="k">prefix</span>
</pre></div> <p>The key must have only one String type attribute that contains an allowed IP prefix. Other types are not supported yet.</p> <p>For queries, you must use the same functions (<code>dictGetT</code> with a tuple) as for dictionaries with composite keys:</p> <div class="codehilite"><pre><span></span><span class="n">dictGetT</span><span class="p">(</span><span class="s1">&#39;dict_name&#39;</span><span class="p">,</span> <span class="s1">&#39;attr_name&#39;</span><span class="p">,</span> <span class="n">tuple</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span>
</pre></div> <p>The function takes either <code>UInt32</code> for IPv4, or <code>FixedString(16)</code> for IPv6:</p> <div class="codehilite"><pre><span></span><span class="n">dictGetString</span><span class="p">(</span><span class="s1">&#39;prefix&#39;</span><span class="p">,</span> <span class="s1">&#39;asn&#39;</span><span class="p">,</span> <span class="n">tuple</span><span class="p">(</span><span class="n">IPv6StringToNum</span><span class="p">(</span><span class="s1">&#39;2001:db8::1&#39;</span><span class="p">)))</span>
</pre></div> <p>Other types are not supported yet. The function returns the attribute for the prefix that corresponds to this IP address. If there are overlapping prefixes, the most specific one is returned.</p> <p>Data is stored in a <code>trie</code>. It must completely fit into RAM.</p> </div> </article> </div> </div> </main> <footer class="md-footer"> <div class="md-footer-nav"> <nav class="md-footer-nav__inner md-grid"> <a href="../external_dicts_dict/index.html" title="配置外部字典" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class="md-flex__ellipsis"> <span class="md-footer-nav__direction"> 后退 </span> 配置外部字典 </span> </div> </a> <a href="../external_dicts_dict_lifetime/index.html" title="字典的刷新策略" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class="md-flex__ellipsis"> <span class="md-footer-nav__direction"> 前进 </span> 字典的刷新策略 </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-footer-copyright"> <div class="md-footer-copyright__highlight"> &copy;2016&ndash;2019 Yandex LLC </div> </div> </div> </div> </footer> </div> <script src="../../../assets/javascripts/modernizr.js"></script> <script src="../../../assets/javascripts/application.js"></script> <script type="text/javascript">
      function ready(callback){
          if (document.readyState != 'loading') {
              callback();
          } else if (document.addEventListener) {
              document.addEventListener('DOMContentLoaded', callback);
          } else document.attachEvent('onreadystatechange', function() {
              if (document.readyState == 'complete') {
                  callback();
              }
          });
      }
      ready(function () {
          var i;
          
          app.initialize({
              version: "1.0.4",
              url: {
                  base: "../../.."
              }
          });
          var beforePrint = function() {
            var details = document.getElementsByTagName("details");
            for (i = 0; i < details.length; ++i) {
                details[i].open = 1;
            }
          };
          if (window.matchMedia) {
              window.matchMedia('print').addListener(function(q) {
                  if (q.matches) {
                      beforePrint();
                  }
              });
          }
          window.onbeforeprint = beforePrint;

          var name = window.location.hostname.split('.')[0];
          var feedback_address = name + '-feedback' + '@yandex-team.ru';
          var feedback_email = document.getElementsByClassName('feedback-email');
          for (i = 0; i < feedback_email.length; i++) {
            feedback_email[i].setAttribute('href', 'mailto:' + feedback_address);
            feedback_email[i].innerHTML = feedback_address;
          }

          document.getElementById("releases-selector").addEventListener(
            "change",
            function() {
              var target = window.location.href.split('docs')[0] + 'docs/';
              if (this.value) {
                target = target + this.value + '/';
              }
              window.location = target + 'zh';
            }
          )
      });
    </script> <!-- Yandex.Metrika counter --> <script type="text/javascript">
        (function (d, w, c) {
            (w[c] = w[c] || []).push(function() {
                try {
                    w.yaCounter18343495 = new Ya.Metrika2({
                        id:18343495,
                        clickmap:true,
                        trackLinks:true,
                        accurateTrackBounce:true,
                        webvisor: true
                    });
                } catch(e) { }
            });
            var n = d.getElementsByTagName("script")[0],
                s = d.createElement("script"),
                f = function () { n.parentNode.insertBefore(s, n); };
            s.type = "text/javascript";
            s.async = true;
            s.src = "https://mc.yandex.ru/metrika/tag.js";
            if (w.opera == "[object Opera]") {
                d.addEventListener("DOMContentLoaded", f, false);
            } else { f(); }
        })(document, window, "yandex_metrika_callbacks2");
    </script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 style="position:absolute; left:-9999px;" alt></div> </noscript> <!-- /Yandex.Metrika counter -->  </body></html>